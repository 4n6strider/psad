#
###########################################################################
#
#  This is the configuration file for psad (the Port Scan Attack Detector).
#  Normally this file gets installed at /etc/psad/psad.conf, but can be put
#  anywhere in the filesystem and then the path can be specified on the
#  command line argument "-c <file>" to psad.  Psad.conf is read by all
#  four of the psad daemons; psad, psadwatchd, diskmond, and kmsgsd.  The
#  syntax of this file is as follows:
#
# -Each line has the form  "<variable name>    <value>;".  Note the semi-
#  colon after the <value>.  All characters after the semicolon will be
#  ignored to provide space for comments.
#
###########################################################################
#
# $Id$
#

### Supports multiple email addresses (as a comma separated
### list).
EMAIL_ADDRESSES             root@localhost;

### Danger levels
DANGER_LEVEL1               5;    ### Number of packets.
DANGER_LEVEL2               50;
DANGER_LEVEL3               1000;
DANGER_LEVEL4               5000;
DANGER_LEVEL5               10000;

### Set the interval (in seconds) psad will use to sleep before
### checking for new iptables log messages
PSAD_CHECK_INTERVAL         5;

### Set the minimum range of ports that must be scanned before
### psad will send an alert.  The default is 1 so that at
### least two port must be scanned (p2-p1 >= 1).  This can be set
### to 0 if you want psad to be extra paranoid, or 30000 if not.
PORT_RANGE_SCAN_THRESHOLD   1;

### If "Y", means that scans will never timeout.
ENABLE_PERSISTENCE          Y;

### This is used only if $ENABLE_PERSISTENCE = "N";
SCAN_TIMEOUT                3600;  ### seconds

### If "Y", means all signatures will be shown since
### the scan started instead of just the current ones.
SHOW_ALL_SIGNATURES         N;

### XXX: try to mitigate the affects of the iptables connection
### tracking bug by ignoring tcp packets that have the ack bit set.
### Read the "BUGS" section of the psad man page.  Note that
### if a packet matches a snort SID (see SNORT_SID_STR variable)
### then psad will see it even if the ack bit is set.
IGNORE_CONNTRACK_BUG_PKTS   Y;

### Send email alert if danger level >= to this value.
EMAIL_ALERT_DANGER_LEVEL    1;

### Send no more than this number of emails for a single
### scanning source ip.
PSAD_EMAIL_LIMIT            50;

### If "Y", send email for all new bad packets instead
### of just when a danger level increases
ALERT_ALL                   Y;

### Directories
PSAD_DIR                    /var/log/psad;
SCAN_DATA_ARCHIVE_DIR       /var/log/psad/scan_archive;
PSAD_ERROR_DIR              /var/log/psad/errs;
SNORT_RULES_DIR             /etc/psad/snort_rules;

### Files
FW_DATA                     /var/log/psad/fwdata;
PSAD_PID_FILE               /var/run/psad/psad.pid;
PSAD_CMDLINE_FILE           /var/run/psad/psad.cmd;
PSAD_SIGS_FILE              /etc/psad/psad_signatures;
PSAD_AUTO_IPS_FILE          /etc/psad/psad_auto_ips;

### Packet counters for tcp, udp, and icmp protocols
PACKET_COUNTER_FILE         /var/log/psad/packet_ctr;

### If "Y", enable automated IDS response (auto manages
### firewall rulesets).
ENABLE_AUTO_IDS             N;

### List of ips that have been auto blocked by iptables, ipchains,
### or tcpwrappers (the auto blocking feature is disabled by
### default, see the psad man page and the ENABLE_AUTO_IDS
### variable).
AUTO_BLOCK_IPT_FILE         /var/log/psad/auto_blocked_iptables;
AUTO_BLOCK_IPCH_FILE        /var/log/psad/auto_blocked_ipchains;
AUTO_BLOCK_TCPWR_FILE       /var/log/psad/auto_blocked_tcpwr;

ERROR_LOG                   /var/log/psad/errs/fwerrorlog;
PRINT_SCAN_HASH             /var/log/psad/scan_hash;

### /proc interface for controlling ip forwarding
PROC_FORWARD_FILE           /proc/sys/net/ipv4/ip_forward;

### Enable iptables blocking (only gets enabled if
### ENABLE_AUTO_IDS is also set)
IPTABLES_BLOCK_METHOD       Y;

### Enable ipchains blocking (only gets enabled if
### ENABLE_AUTO_IDS is also set)
IPCHAINS_BLOCK_METHOD       N;

### Enable tcp wrappers blocking
TCPWRAPPERS_BLOCK_METHOD    N;

### Block all traffic from offending IP if danger
### level >= to this value
AUTO_IDS_DANGER_LEVEL       5;

### Set the auto-blocked timeout in seconds (the default
### is one hour).
AUTO_BLOCK_TIMEOUT          3600;

### Set the whois timeout
WHOIS_TIMEOUT               60;  ### seconds

### Set the number of times an ip can be seen before another whois
### lookup is issued.
WHOIS_THRESHOLD             20;

### The following variables can be modified to look for logging messages
### that are specific to your firewall configuration (specified by the
### "--log-prefix" for iptables firewalls).  For example, if your firewall
### uses the string "Audit" for packets that have been blocked, then you
### could set FW_MSG_SEARCH = "Audit";
FW_MSG_SEARCH               DROP;
SNORT_SID_STR               SID;  ### for snort "sid" values generated
                                  ### by fwsnort or snort2iptables

### kmsgsd specific variables
KMSGSD_PID_FILE             /var/run/psad/kmsgsd.pid;
PSAD_FIFO                   /var/lib/psad/psadfifo;

### diskmond specific variables
DISKMOND_PID_FILE           /var/run/psad/diskmond.pid;
MAX_DISK_PERCENTAGE         95;
DISKMOND_CHECK_INTERVAL     60;  ### seconds
DISKMOND_MAX_RETRIES        50;

### psadwatchd specific variables
PSADWATCHD_PID_FILE         /var/run/psad/psadwatchd.pid;
PSADWATCHD_CHECK_INTERVAL   5;  ### seconds
PSADWATCHD_MAX_RETRIES      10;

### system binaries
shCmd          /bin/sh;
ipchainsCmd    /sbin/ipchains;
iptablesCmd    /sbin/iptables;
dfCmd          /bin/df;
mknodCmd       /bin/mknod;
psCmd          /bin/ps;
mailCmd        /bin/mail;
ifconfigCmd    /sbin/ifconfig;
syslogdCmd     /sbin/syslogd;
killallCmd     /usr/bin/killall;
netstatCmd     /bin/netstat;
unameCmd       /bin/uname;
whoisCmd       /usr/bin/whois_psad;
psadwatchdCmd  /usr/sbin/psadwatchd;
kmsgsdCmd      /usr/sbin/kmsgsd;
diskmondCmd    /usr/sbin/diskmond;
psadCmd        /usr/sbin/psad;
