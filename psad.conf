#
###########################################################################
#
#  This is the configuration file for psad (the Port Scan Attack Detector).
#  Normally this file gets installed at /etc/psad/psad.conf, but can be put
#  anywhere in the filesystem and then the path can be specified on the
#  command line argument "-c <file>" to psad.  Psad.conf is read by all
#  four of the psad daemons; psad, psadwatchd, diskmond, and kmsgsd.  The
#  syntax of this file is as follows:
#
# -Each line has the form  "<variable name>    <value>;".  Note the semi-
#  colon after the <value>.  All characters after the semicolon will be
#  ignored so provides space for comments.
#
###########################################################################
#
# $Id$
#

PSAD_DIR                    /var/log/psad;
SCAN_DATA_ARCHIVE_DIR       /var/log/psad/scan_archive;
PSAD_ERROR_DIR              /var/log/psad/errs;
ERROR_LOG                   /var/log/psad/errs/fwerrorlog;
PSAD_PID_FILE               /var/run/psad/psad.pid;
PSAD_CMDLINE_FILE           /var/run/psad/psad.cmd;
PACKET_COUNTER_FILE         /var/log/psad/packet_ctr.txt;
FW_DATA                     /var/log/psad/fwdata;
PRINT_SCAN_HASH             /var/log/psad/scan_hash;
PSAD_CHECK_INTERVAL         15;  ### (seconds).
PORT_RANGE_SCAN_THRESHOLD   1;
### If "Y", means that scans will never timeout.
ENABLE_PERSISTENCE          Y;
### This is used only if $ENABLE_PERSISTENCE = "N";
SCAN_TIMEOUT                3600;
### If "Y", means all signatures will be shown since
### the scan started instead of just the current ones.
SHOW_ALL_SIGNATURES         N;
DANGER_LEVEL1               5;    ### Number of packets.
DANGER_LEVEL2               50;
DANGER_LEVEL3               1000;
DANGER_LEVEL4               5000;
DANGER_LEVEL5               10000;
### Send email alert if danger level >= to this value.
EMAIL_ALERT_DANGER_LEVEL    1;
### Send no more than this number of emails for a single
### scanning source ip.
PSAD_EMAIL_LIMIT            50;
### Supports multiple email addresses.
EMAIL_ADDRESSES             root@localhost;
### If "Y", send email for all new bad packets instead
### of just when a danger level increases
ALERT_ALL                   Y;

### If "Y", enable automated IDS response (auto manages
### firewall rulesets).
ENABLE_AUTO_IDS             N;
### Enable iptables blocking (only gets enabled if
### ENABLE_AUTO_IDS is also set)
IPTABLES_BLOCK_METHOD       Y;
### Enable ipchains blocking (only gets enabled if
### ENABLE_AUTO_IDS is also set)
IPCHAINS_BLOCK_METHOD       N;
### Enable tcp wrappers blocking
TCPWRAPPERS_BLOCK_METHOD    N;
### Block all traffic from offending IP if danger
### level >= to this value
AUTO_IDS_DANGER_LEVEL       5;
### Send a "BLOCKED" alert every time psad automatically
### blocks an ip addresss.
ALERT_AUTO_BLOCKED          Y;
### Set the whois timeout
WHOIS_TIMEOUT               60;  ### (seconds)
### Set the number of times an ip can be seen before another whois
WHOIS_THRESHOLD             5;

### The following variables can be modified to look for logging messages
### that are specific to your firewall configuration (specified by the
### "--log-prefix" for iptables firewalls).  For example, if your firewall
### uses the string "Audit" for packets that have been blocked, then you
### could set FW_MSG_SEARCH = "Audit";
FW_MSG_SEARCH               DROP;

### kmsgsd specific variables
KMSGSD_PID_FILE             /var/run/psad/kmsgsd.pid;
PSAD_FIFO                   /var/lib/psad/psadfifo;

### diskmond specific variables
DISKMOND_PID_FILE           /var/run/psad/diskmond.pid;
MAX_DISK_PERCENTAGE         95;
DISKMOND_CHECK_INTERVAL     60;
DISKMOND_MAX_RETRIES        50;

### psadwatchd specific variables
PSADWATCHD_PID_FILE         /var/run/psad/psadwatchd.pid;
PSADWATCHD_CHECK_INTERVAL   5;
PSADWATCHD_MAX_RETRIES      10;

### system binaries
ipchainsCmd    /sbin/ipchains;
iptablesCmd    /sbin/iptables;
dfCmd          /bin/df;
mknodCmd       /bin/mknod;
psCmd          /bin/ps;
mailCmd        /bin/mail;
ifconfigCmd    /sbin/ifconfig;
syslogdCmd     /sbin/syslogd;
killallCmd     /usr/bin/killall;
netstatCmd     /bin/netstat;
unameCmd       /bin/uname;
whoisCmd       /usr/bin/whois.psad;
psadwatchdCmd  /usr/sbin/psadwatchd;
kmsgsdCmd      /usr/sbin/kmsgsd;
diskmondCmd    /usr/sbin/diskmond;
psadCmd        /usr/sbin/psad;
